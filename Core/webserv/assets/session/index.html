<!DOCTYPE html>
<html lang="en">

<head>
	<link rel="icon" href="data:,">
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<title>Session Demo</title>
	<style>
		:root {
			--bg: #140f14;
			--card: #241824;
			--text: #fff0f5;
			--muted: #ff9bb3;
			--accent1: #ff6aae;
			--accent2: #ffa178;
			--accent3: #5cf2b2;
			--ring: #ff6a9933;
			--danger: #ff6a6a;
			--shadow: 0 20px 60px rgba(0, 0, 0, .4);
			--radius: 18px;
		}

		@media (prefers-color-scheme: light) {
			:root {
				--bg: #fcf6fc;
				--card: #ffffff;
				--text: #140f14;
				--muted: #8a5a6b;
				--ring: #ff6a9920;
				--shadow: 0 20px 40px rgba(2, 7, 27, .12);
			}
		}

		* {
			box-sizing: border-box;
		}

		html,
		body {
			height: 100%;
		}

		body {
			margin: 0;
			background:
				radial-gradient(1200px 700px at 10% 0%, #201020 0%, var(--bg) 60%),
				radial-gradient(1200px 700px at 90% 100%, #241820 0%, var(--bg) 60%);
			color: var(--text);
			font: 500 16px/1.6 system-ui, "Segoe UI", Roboto, Inter, Arial, sans-serif;
			display: grid;
			place-items: center;
			padding: 20px;
		}

		.wrap {
			width: min(600px, 92%);
			text-align: center;
			position: relative;
		}

		.card {
			background: linear-gradient(180deg, rgba(255, 255, 255, .03), rgba(255, 255, 255, .02));
			border-radius: var(--radius);
			padding: 32px 28px;
			box-shadow: var(--shadow);
			border: 1px solid var(--ring);
			backdrop-filter: blur(8px);
		}

		h2 {
			margin: 0 0 20px;
			font-size: 32px;
			letter-spacing: 0.5px;
			background: linear-gradient(135deg, var(--accent1), var(--accent3));
			-webkit-background-clip: text;
			-webkit-text-fill-color: transparent;
			background-clip: text;
		}

		.art {
			position: relative;
			height: 80px;
			margin: 10px auto 20px;
			width: 100%;
		}

		svg {
			position: absolute;
			inset: 0;
			width: 100%;
			height: 100%;
		}

		.glow {
			filter: blur(24px);
			opacity: .55;
		}

		.status {
			padding: 16px;
			margin: 20px 0;
			border-radius: var(--radius);
			background: linear-gradient(90deg, #341224, #2a1816);
			border: 1px solid var(--ring);
			color: var(--muted);
			font-weight: 600;
		}

		.status b {
			color: var(--text);
		}

		.btns {
			display: flex;
			flex-wrap: wrap;
			gap: 12px;
			justify-content: center;
			margin-top: 18px;
		}

		button {
			display: inline-block;
			padding: 12px 18px;
			border-radius: 12px;
			border: 1px solid var(--ring);
			text-decoration: none;
			color: var(--text);
			font-weight: 700;
			letter-spacing: .2px;
			background: linear-gradient(135deg, #341224, #241824);
			box-shadow: 0 6px 20px rgba(0, 0, 0, .25);
			cursor: pointer;
			transition: transform 0.2s ease;
		}

		button:hover {
			transform: translateY(-1px);
		}

		button.primary {
			background: linear-gradient(135deg, var(--accent1), var(--accent3));
			color: #140f14;
		}

		button.ghost {
			background: transparent;
		}
	</style>
</head>

<body>
	<div class="wrap">
		<div class="card">
			<h2>Session Demo</h2>

			<div class="art" aria-hidden="true">
				<svg id="abstractArt" viewBox="0 0 600 80" xmlns="http://www.w3.org/2000/svg" role="img">
					<!-- SVG content will be generated by JavaScript -->
				</svg>
			</div>

			<div id="status" class="status">Loading session info...</div>

			<div class="btns">
				<button class="primary" onclick="login()">Login</button>
				<button class="ghost" onclick="logout()">Logout</button>
				<button class="ghost" onclick="clearCookie()">Clear Cookie</button>
			</div>
		</div>
	</div>

	<script>
		// Generate random abstract art
		function generateAbstractArt() {
			const svg = document.getElementById('abstractArt');
			svg.innerHTML = '';

			// Create gradients
			const defs = document.createElementNS('http://www.w3.org/2000/svg', 'defs');

			const gradient1 = document.createElementNS('http://www.w3.org/2000/svg', 'linearGradient');
			gradient1.setAttribute('id', 'g1');
			gradient1.setAttribute('x1', '0');
			gradient1.setAttribute('x2', '1');
			gradient1.setAttribute('y1', '0');
			gradient1.setAttribute('y2', '1');

			const stop1 = document.createElementNS('http://www.w3.org/2000/svg', 'stop');
			stop1.setAttribute('offset', '0%');
			stop1.setAttribute('stop-color', 'var(--accent1)');

			const stop2 = document.createElementNS('http://www.w3.org/2000/svg', 'stop');
			stop2.setAttribute('offset', '100%');
			stop2.setAttribute('stop-color', 'var(--accent3)');

			gradient1.appendChild(stop1);
			gradient1.appendChild(stop2);

			const gradient2 = document.createElementNS('http://www.w3.org/2000/svg', 'linearGradient');
			gradient2.setAttribute('id', 'g2');
			gradient2.setAttribute('x1', '0');
			gradient2.setAttribute('x2', '1');
			gradient2.setAttribute('y1', '0');
			gradient2.setAttribute('y2', '1');

			const stop3 = document.createElementNS('http://www.w3.org/2000/svg', 'stop');
			stop3.setAttribute('offset', '0%');
			stop3.setAttribute('stop-color', 'var(--accent2)');

			const stop4 = document.createElementNS('http://www.w3.org/2000/svg', 'stop');
			stop4.setAttribute('offset', '100%');
			stop4.setAttribute('stop-color', 'var(--accent1)');

			gradient2.appendChild(stop3);
			gradient2.appendChild(stop4);

			defs.appendChild(gradient1);
			defs.appendChild(gradient2);
			svg.appendChild(defs);

			// Generate random glow positions
			const glow1 = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
			glow1.setAttribute('class', 'glow');
			glow1.setAttribute('cx', Math.random() * 400 + 100);
			glow1.setAttribute('cy', Math.random() * 40 + 20);
			glow1.setAttribute('r', Math.random() * 20 + 20);
			glow1.setAttribute('fill', 'var(--accent1)');

			const glow2 = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
			glow2.setAttribute('class', 'glow');
			glow2.setAttribute('cx', Math.random() * 400 + 100);
			glow2.setAttribute('cy', Math.random() * 40 + 20);
			glow2.setAttribute('r', Math.random() * 20 + 20);
			glow2.setAttribute('fill', 'var(--accent2)');

			svg.appendChild(glow1);
			svg.appendChild(glow2);

			// Generate random line path
			const path1 = document.createElementNS('http://www.w3.org/2000/svg', 'path');
			let pathData = `M50 ${Math.random() * 30 + 25}`;

			// Generate 6 random points
			for (let i = 1; i <= 6; i++) {
				const x = 50 + (i * 80);
				const y = Math.random() * 60 + 10;
				pathData += ` L${x} ${y}`;
			}

			path1.setAttribute('d', pathData);
			path1.setAttribute('fill', 'none');
			path1.setAttribute('stroke', 'url(#g1)');
			path1.setAttribute('stroke-width', '4');
			path1.setAttribute('stroke-linecap', 'round');

			// Generate second random line path
			const path2 = document.createElementNS('http://www.w3.org/2000/svg', 'path');
			let pathData2 = `M${Math.random() * 30 + 20} ${Math.random() * 30 + 40}`;

			// Generate 6 random points
			for (let i = 1; i <= 6; i++) {
				const x = 50 + (i * 80);
				const y = Math.random() * 60 + 10;
				pathData2 += ` L${x} ${y}`;
			}

			path2.setAttribute('d', pathData2);
			path2.setAttribute('fill', 'none');
			path2.setAttribute('stroke', 'url(#g2)');
			path2.setAttribute('stroke-width', '3');
			path2.setAttribute('stroke-linecap', 'round');

			// Randomly decide if we use a dashed pattern
			if (Math.random() > 0.5) {
				path2.setAttribute('stroke-dasharray', `${Math.floor(Math.random() * 8) + 3} ${Math.floor(Math.random() * 5) + 2}`);
			}

			svg.appendChild(path1);
			svg.appendChild(path2);
		}

		// Generate art on page load
		generateAbstractArt();

		// Also regenerate when buttons are clicked
		document.querySelectorAll('button').forEach(button => {
			button.addEventListener('click', () => {
				// Small delay to let the animation finish
				setTimeout(generateAbstractArt, 300);
			});
		});

		async function update() {
			const res = await fetch('/session/info');
			const data = await res.json();
			const status = document.getElementById('status');
			if (data.logged_in)
				status.innerHTML = `Logged in ✅ — Visits: <b>${data.visits}</b>`;
			else
				status.innerHTML = `Not logged in ❌`;
		}

		async function login() {
			await fetch('/session/login');
			update();
		}

		async function logout() {
			await fetch('/session/logout');
			update();
		}

		async function clearCookie() {
			await fetch('/session/clear');
			update();
		}

		update();
	</script>
</body>

</html>